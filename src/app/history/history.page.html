<ion-header [translucent]="true">
  <ion-toolbar class="app-text">
    <ion-buttons slot="start">
      <a routerLink="/home" class="flex items-center mr-2">
        <img src="assets/kodbro-logo.png" alt="KodBro" class="h-8 object-contain" />
      </a>
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>My Apps</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="bg-cream app-text">
  <div class="history-inner px-4 py-4 max-w-2xl mx-auto">
    <h2 class="text-lg font-semibold mb-4">App history</h2>
    <p class="text-sm opacity-90 mb-6">
      Apps you've created with KodBro.
    </p>

    @if (loading) {
      <ion-spinner name="crescent"></ion-spinner>
    } @else if (error) {
      <ion-note color="danger" class="block">{{ error }}</ion-note>
    } @else if (jobs.length === 0) {
      <p class="text-sm opacity-80">No apps yet. Create one from the home page.</p>
    } @else {
      <ion-list lines="full">
        @for (job of jobs; track job.id) {
          <ion-item>
            <ion-label>
              <h3>{{ job.app_name }}</h3>
              <p class="text-sm opacity-80">{{ formatDate(job.created_at) }}</p>
              @if (job.repo_url) {
                <p class="text-xs mt-1">
                  <a [href]="job.repo_url" target="_blank" rel="noopener">Repo</a>
                  @if (job.deploy_url) {
                    Â· <a [href]="job.deploy_url" target="_blank" rel="noopener">Deploy</a>
                  }
                </p>
              }
            </ion-label>
            <ion-badge [color]="statusColor(job.status)" slot="end">
              {{ job.status }}
            </ion-badge>
          </ion-item>
        }
      </ion-list>
    }
  </div>
</ion-content>
